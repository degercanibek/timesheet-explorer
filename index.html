<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timesheet Explorer</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/marked@11.1.1/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
    
    <!-- Embedded USER_GUIDE.md content as fallback for file:// protocol -->
    <script id="embedded-user-guide" type="text/markdown">
# Timesheet Explorer - User Guide

<div align="center">

**[üîó View on GitHub](https://github.com/degercanibek/timesheet-explorer)**

</div>

Welcome to Timesheet Explorer! This comprehensive guide will help you make the most of this powerful timesheet analysis tool.

## Table of Contents

- [Getting Started](#getting-started)
- [Mapping Tab](#mapping-tab)
- [Timesheet Data Tab](#timesheet-data-tab)
- [Reports Tab](#reports-tab)
- [Filters](#filters)
- [Common Scenarios](#common-scenarios)

---

## Getting Started

Timesheet Explorer is a web-based tool for analyzing timesheet data from Jira project management systems. It helps you:
- Map people to teams, projects, and roles
- Import and filter timesheet data
- Generate visual reports and charts
- Analyze work distribution across teams, projects, and time periods

### First Time Setup

1. **Start with the Mapping tab** to set up your organizational structure
2. **Import timesheet data** in the Timesheet Data tab
3. **Generate reports** in the Reports tab

---

## Mapping Tab

The Mapping tab is where you define your organizational structure.

### Projects

**What are Projects?**
Projects represent the main initiatives or products your team works on.

**How to add a Project:**
1. Click the "Add" button in the Projects column
2. Enter the project name
3. Click "Save"

**Example:** "Customer Portal", "Mobile App", "Infrastructure"

### Teams

**What are Teams?**
Teams are groups of people working together, often aligned with projects or functional areas.

**How to add a Team:**
1. Click the "Add" button in the Teams column
2. Enter the team name
3. Click "Save"

**Example:** "Backend Team", "Frontend Team", "DevOps"

### Roles

**What are Roles?**
Roles define what people do in your organization. Each role can have a default Work Type.

**How to add a Role:**
1. Click the "Add" button in the Roles column
2. Enter the role name
3. Optionally select a default Work Type
4. Click "Save"

**Example:** "Developer", "QA Engineer", "Designer", "Product Manager"

### Work Types

**What are Work Types?**
Work Types categorize the kind of work being done (e.g., Development, Testing, Review, Meeting).

**How to add a Work Type:**
1. Click the "Add" button in the Work Types column
2. Enter the work type name
3. Click "Save"

**Example:** "Development", "Code Review", "Testing", "Planning", "Documentation"

**üí° Tip:** Work Types can be linked to Roles as defaults. When you apply mapping, people get their role's default work type automatically.

### People

**What is the People section?**
Here you assign each person to a team, project, and role.

**How to add a Person:**
1. Click the "Add" button
2. Enter the person's name (must match how it appears in your timesheet CSV)
3. Select their team from the dropdown
4. Select their project from the dropdown
5. Select their role from the dropdown
6. Click "Save"

**Importing People from CSV:**
If you have many people to add, use the "From CSV" button:
1. Click "From CSV"
2. Select a timesheet CSV file
3. The system will extract unique names
4. You can then edit each person's team, project, and role

**Filtering the People Table:**
Use the filter dropdowns above the People table to narrow down the list:
- **Search**: Filter by name
- **Team**: Show only people in specific teams
- **Project**: Show only people in specific projects
- **Role**: Show only people with specific roles

**üí° Tip:** Make sure person names in the mapping exactly match the "Full name" column in your timesheet data!

---

## Timesheet Data Tab

This is where you import, view, and filter your actual timesheet records.

### Importing Data

**Step-by-step:**
1. Click "Import CSV" button
2. Select your timesheet CSV file
3. Wait for the import to complete
4. You'll see a summary of imported records

**Required CSV Columns:**
- Full name
- Hours
- Work date
- Activity Name
- Issue summary
- Issue Status
- Project Key
- (Optional) Team, Project, Servis, Epic

**Large Datasets:**
The application uses IndexedDB to handle large datasets (17,000+ rows). Your data is stored locally in your browser.

### Viewing Filtered Data

After importing, you'll see your timesheet data in a table with these columns:
- Work Date (formatted as "1 Jan '25")
- Servis (service number with name)
- Project Key
- Person Name
- Activity Name
- Issue Summary
- Issue Status
- Efor (hours)
- Team
- Project

### Filters

<a name="filters"></a>

**Understanding Filters:**
Filters help you narrow down your data to specific criteria.

**How to use a filter:**
1. Find the filter you want to use (Project, Team, Role, etc.)
2. Click inside the dropdown
3. Hold Ctrl (Windows) or Cmd (Mac) to select multiple options
4. The data updates automatically

**The "not" option:**
Each filter has a small "not" checkbox on the right side of the filter label.

**Normal filtering (not unchecked):**
- Selects only the chosen items
- Example: Select "ProjectA" and "ProjectB" ‚Üí Shows only ProjectA and ProjectB records

**Inverted filtering (not checked):**
- Excludes the chosen items, shows everything else
- Example: Select "ProjectA" and "ProjectB", check "not" ‚Üí Shows all projects EXCEPT ProjectA and ProjectB

**üí° Tip:** Use "not" filtering to quickly exclude certain projects, teams, or people from your analysis!

**Available Filters:**
- **Project**: Filter by project name
- **Team**: Filter by team name
- **Role**: Filter by person's role
- **Work Type**: Filter by type of work
- **Servis**: Filter by service number
- **Work Date From/To**: Filter by date range
- **Issue Summary**: Search text in issue descriptions
- **Activity Name** (Advanced): Filter by type of activity (Development, Review, etc.)
- **Person** (Advanced): Filter by specific people
- **Issue Status** (Advanced): Filter by Jira status (In Progress, Done, etc.)
- **Project Key** (Advanced): Filter by Jira project key

<a name="date-filters"></a>

**Clearing Filters:**
Each filter has a small √ó button that appears when the filter is active. Click it to clear that specific filter.

**Date Filters:**
1. Click on "Work Date From" to set the start date
2. Click on "Work Date To" to set the end date
3. Click the √ó button next to the label to clear a date filter
4. Leave either blank to filter from the beginning or to the end

### Batch Updates

**Selecting Records:**
- Click checkboxes to select individual records
- Use "Select All" to select all records on current page
- Use "All X filtered records" to select ALL records matching your filters (across all pages)

**Updating Selected Records:**
1. Select records using checkboxes
2. Click "Update Selected" button
3. Choose what to update (Team, Project, or both)
4. Select new values from dropdowns
5. Click "Apply"

**Apply Mapping:**
Use the "Apply Mapping" button to automatically fill in Team, Project, and Work Type information based on your People mapping:

1. **Without "Override existing" checked**: Only fills in empty fields. Records that already have Team, Project, or Work Type information are left unchanged.
2. **With "Override existing" checked**: Updates ALL records with the person's mapped Team, Project, and their role's default Work Type, even if those fields already have values.

**üí° Tip:** Use "Apply Mapping" without override to complete partial data, or with override to standardize all records to match your current mapping.

**Servis Management:**
1. Click "Manage Servis" button
2. See all service numbers found in your data
3. Add custom names to service numbers (e.g., "5215 - General Efforts")
4. These names will appear throughout the application

**Clearing Data:**
Click "Clear All" button to remove all imported timesheet data. You'll need to confirm twice to prevent accidents.

---

## Reports Tab

The Reports tab is where you generate visual analytics and charts.

### Setting Up a Report

**Step 1: Apply Filters (Optional)**
The Reports tab has its own independent set of filters. These filters work separately from the Timesheet Data tab filters, allowing you to analyze different data subsets without affecting your filtered view in the Timesheet Data tab.

**Step 2: Choose Report Type**
Select what you want to analyze:
- **Person Name**: Hours per person
- **Team**: Hours per team
- **Project**: Hours per project
- **Role**: Hours per role
- **Work Type**: Hours per work type
- **Activity Name**: Hours per activity type
- **Servis**: Hours per service number
- **Issue Status**: Hours per issue status
- **Epic**: Hours per epic
- **Project Key**: Hours per Jira project
- **Issue Key**: Hours per specific issue

**Step 3: Choose Chart Type**
- **Donut Chart**: Shows distribution as a circular chart
- **Time Series**: Shows data over time as a bar chart

**Step 4: Choose Time Period** (for Time Series)
- **Daily**: One bar per day
- **Weekly**: One bar per week (labeled as "Week 1, 2025")
- **Monthly**: One bar per month
- **Quarterly**: One bar per quarter

**Step 5: Customize Appearance**
- **Theme**: Choose color palette (Default, Pastel, Vibrant, etc.)
- **Font**: Choose font family
- **Font Size**: Increase/decrease with A- and A+ buttons
- **Rotation**: Adjust the starting angle of the donut chart

**Step 6: Generate**
Click the "üìà Generate Chart" button below the filters.

### Understanding Charts

**Units Display:**
Charts show values with appropriate units:
- When viewing in Hours mode: values show as "1,234h"
- When viewing in Man-days mode: values show as "154md"

**Donut Chart:**
- Shows top 20 categories by hours
- Center displays total value with unit abbreviation
- Each slice is labeled with name, value, and percentage
- Larger slices = more hours/man-days

**Time Series Chart:**
- Shows hours over time periods
- Stacked bars colored by your Report Type
- Hover to see detailed breakdown
- Bottom shows time period labels

### Report Data Points

Below the chart, you'll see a list of all data points in your report.

**What you can do:**
- **Reorder**: Drag and drop items to change their order in the chart
- **Hide/Show**: Click the eye icon to hide/show items from the chart
- **Edit Label**: Click the pencil icon to change how an item is labeled
- **Change Color**: Click the color box to pick a custom color for each item
- **View Details**: Click the info icon (‚ÑπÔ∏è) to see detailed statistics and records for that data point

**Color Consistency:**
Colors remain consistent between Donut and Time Series views. If "Team A" is red in the donut chart, it will also be red in the time series chart.

**Data Point Details:**
Clicking the info icon (‚ÑπÔ∏è) opens a popup showing:
- Statistics (total records, unique people, total hours/man-days)
- Date range used for the report
- All individual records for that data point
- Filters to further narrow down the records
- Export option to download the filtered data as CSV

---

## Common Scenarios

### Scenario 1: "I want to see how much time my team spent on each project last month"

**Steps:**
1. Go to **Timesheet Data** tab
2. Set **Work Date From** to first day of last month
3. Set **Work Date To** to last day of last month
4. In **Team** filter, select your team
5. Go to **Reports** tab
6. Set **Report Type** to "Project"
7. Click **Generate Chart**

**Result:** You'll see a donut chart showing hours per project for your team last month.

---

### Scenario 2: "Show me all work EXCEPT two specific projects"

**Steps:**
1. Go to **Reports** tab (or Timesheet Data tab)
2. In **Project** filter, select the two projects you want to exclude
3. Check the small **"not"** checkbox next to the Project label
4. Generate your report

**Result:** The report includes all projects except the two you selected.

---

### Scenario 3: "I need a weekly breakdown of hours by team for Q1 2025"

**Steps:**
1. Go to **Reports** tab
2. Set **Work Date From** to "2025-01-01"
3. Set **Work Date To** to "2025-03-31"
4. Set **Report Type** to "Team"
5. Set **Chart Type** to "Time Series"
6. Set **Time Period** to "Weekly"
7. Click **Generate Chart**

**Result:** You'll see a stacked bar chart with one bar per week, colored by team.

---

### Scenario 4: "Bulk update 500 records from TeamA to TeamB"

**Steps:**
1. Go to **Timesheet Data** tab
2. In **Team** filter, select "TeamA"
3. Check the **"All X filtered records"** checkbox at the top
4. Click **Update Selected** button
5. Select **Team**: "TeamB"
6. Click **Apply**

**Result:** All filtered records are updated to TeamB, across all pages.

---

### Scenario 5: "Compare time spent on 'Development' vs 'Review' activities over the last 6 months"

**Steps:**
1. Go to **Reports** tab
2. Set **Work Date From** to 6 months ago
3. In **Activity Name** filter, select "Development" and "Review"
4. Set **Report Type** to "Activity Name"
5. Set **Chart Type** to "Time Series"
6. Set **Time Period** to "Monthly"
7. Click **Generate Chart**

**Result:** Monthly bar chart showing Development vs Review hours stacked.

---

### Scenario 6: "Find all work on Jira issues that contain 'bug' in the summary"

**Steps:**
1. Go to **Timesheet Data** tab
2. Click **"+ Advanced Filters"**
3. In **Issue Summary** field, type "bug"
4. Data table updates automatically

**Result:** Only records where the issue summary contains "bug" are shown.

---

### Scenario 7: "Exclude all work on Jira issues containing 'meeting'"

**Steps:**
1. Go to **Timesheet Data** tab
2. Click **"+ Advanced Filters"**
3. In **Issue Summary** field, type "meeting"
4. Check the **"NOT"** checkbox next to the Issue Summary field
5. Data table updates automatically

**Result:** All records EXCEPT those with "meeting" in the summary are shown.

---

## Tips & Tricks

### üí° Performance Tips
- For large datasets (10,000+ rows), be patient during initial import
- Filters are applied instantly, so start with broader filters and narrow down
- Use "Clear All" to reset and start fresh if things feel slow

### üí° Data Quality Tips
- Ensure consistent naming in your CSV (e.g., always "Backend Team", not sometimes "Backend" or "BE Team")
- Use the Servis Management feature to give meaningful names to service numbers
- Regularly review the Mapping tab to keep teams/projects up to date

### üí° Reporting Tips
- Start with broader report types (Team, Project) before drilling into specifics (Person, Issue Key)
- Use Time Series with Monthly/Quarterly for long-term trends
- Use Donut charts to quickly spot who/what is taking the most time
- Save screenshots of your charts for presentations
- Use color customization to match your company's branding

### üí° Filter Tips
- The "not" feature is powerful for exclusion-based analysis
- Combine multiple filters for precise slicing (e.g., Team + Project + Date range)
- Use Advanced Filters for one-off analyses without cluttering main filters
- Clear filters between different analyses to avoid confusion

---

## Troubleshooting

### Problem: "My CSV import failed"

**Solutions:**
- Check that your CSV has a "Full name" and "Hours" column
- Ensure the file is properly formatted CSV (not Excel .xlsx)
- Try opening the CSV in a text editor to check for special characters
- Make sure the file isn't too corrupted or in an unusual format

---

### Problem: "I don't see any data after importing"

**Solutions:**
- Check if you have filters applied (clear them with "Clear Filters")
- Make sure you're on the "Timesheet Data" tab
- Try refreshing the page and re-importing

---

### Problem: "Person names don't match between Mapping and Timesheet Data"

**Solutions:**
- Go to Mapping > People and check exact spelling
- CSV might have extra spaces or middle names
- Use "From CSV" in People section to auto-extract names from your timesheet

---

### Problem: "Charts look weird or colors don't match"

**Solutions:**
- Try changing the Theme in report customization
- Click on a data point's color picker to manually set colors
- Refresh the page if colors seem cached incorrectly

---

### Problem: "I want to reset everything and start over"

**Solutions:**
- Go to Timesheet Data tab and click "Clear All" (removes all timesheet data)
- For mapping data (projects/teams/roles/people), manually delete items or refresh the page and don't save
- Your data is stored in browser's local storage and IndexedDB, so clearing browser data will also reset

---

## Keyboard Shortcuts

- **Ctrl/Cmd + Click**: Multi-select in filter dropdowns
- **Shift + Click**: Range select (select from last clicked to current)
- **Tab**: Navigate between form fields
- **Escape**: Close modals/popups

---

## Browser Compatibility

Timesheet Explorer works best in modern browsers:
- ‚úÖ Chrome/Edge (recommended)
- ‚úÖ Firefox
- ‚úÖ Safari
- ‚ö†Ô∏è Internet Explorer not supported

---

## Data Privacy

**Your data stays local!**
- All data is stored in your browser's local storage and IndexedDB
- Nothing is sent to external servers
- Data persists between sessions (until you clear browser data)
- To truly delete data, use "Clear All" or clear your browser's local storage

---

## Support & Feedback

### üêõ Report Issues

Found a bug or have a problem? Please report it on GitHub:

**[üìù Open a New Issue](https://github.com/degercanibek/timesheet-explorer/issues/new)**

When reporting an issue, please include:
- A clear description of the problem
- Steps to reproduce the issue
- Browser and version you're using
- Screenshots if applicable

### üí° Feature Requests

Have an idea for a new feature? We'd love to hear it!

**[‚ú® Request a Feature](https://github.com/degercanibek/timesheet-explorer/issues/new)**

Describe your feature idea and how it would help your workflow.

### üìö Documentation & Source Code

View the full source code, documentation, and contribute to the project:

**[GitHub Repository](https://github.com/degercanibek/timesheet-explorer)**

---

**Version:** 2.1
**Last Updated:** December 28, 2025

---

**Happy Analyzing! üìä**
    </script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Timesheet Explorer</h1>
            <div class="unit-switch-container">
                <span class="unit-switch-label">Hours</span>
                <label class="switch">
                    <input type="checkbox" id="unit-toggle">
                    <span class="slider"></span>
                </label>
                <span class="unit-switch-label">Man-days</span>
            </div>
        </header>

        <!-- Tab Navigation -->
        <div class="sticky-tabs">
            <div class="tab-navigation">
                <button class="tab-btn active" data-tab="mapping">Teams & People</button>
                <button class="tab-btn" data-tab="data">Timesheet Data</button>
                <button class="tab-btn" data-tab="reports">Reports</button>
                <button class="tab-btn guide-tab-btn" data-tab="help">üìñ Guide</button>
            </div>
        </div>

        <!-- Tab Content -->
        <div class="tab-content active" id="tab-mapping">
            <!-- Import/Export Actions -->
            <div class="import-export-section">
                <button id="import-all-btn" class="action-btn" title="Import project-team-people data (JSON)">üì§ Import</button>
                <button id="export-all-btn" class="action-btn" title="Export project-team-people data (JSON)">üì• Export</button>
            </div>

            <!-- Sub-tabs Navigation -->
            <div class="sub-tabs">
                <button class="sub-tab-btn active" data-subtab="projects">Projects</button>
                <button class="sub-tab-btn" data-subtab="teams">Teams</button>
                <button class="sub-tab-btn" data-subtab="roles">Roles</button>
                <button class="sub-tab-btn" data-subtab="work-types">Work Types</button>
            </div>

            <!-- Projects Sub-tab Content -->
            <div class="sub-tab-content active" id="subtab-projects">
                <section class="card">
                    <div class="column-header">
                        <div class="section-header-with-help">
                            <h2>Projects</h2>
                            <a href="#" class="section-help-icon" data-help="mapping-tab" title="Help: How to use Projects">?</a>
                        </div>
                        <button id="add-project-btn" class="btn btn-secondary">Add</button>
                    </div>
                    <div class="filter-search">
                        <input type="text" id="project-search" placeholder="Search projects..." class="input">
                    </div>
                    <div class="table-container">
                        <table class="entity-table">
                            <thead>
                                <tr>
                                    <th class="row-number-col">#</th>
                                    <th>Project name</th>
                                    <th>People</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="project-tbody">
                                <tr class="empty-row">
                                    <td colspan="4">No projects</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="pagination" id="project-pagination"></div>
                </section>
            </div>

            <!-- Teams Sub-tab Content -->
            <div class="sub-tab-content" id="subtab-teams">
                <section class="card">
                    <div class="column-header">
                        <div class="section-header-with-help">
                            <h2>Teams</h2>
                            <a href="#" class="section-help-icon" data-help="mapping-tab" title="Help: How to use Teams">?</a>
                        </div>
                        <button id="add-team-btn" class="btn btn-secondary">Add</button>
                    </div>
                    <div class="filter-search">
                        <input type="text" id="team-search" placeholder="Search teams..." class="input">
                    </div>
                    <div class="table-container">
                        <table class="entity-table">
                            <thead>
                                <tr>
                                    <th class="row-number-col">#</th>
                                    <th>Team name</th>
                                    <th>People</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="team-tbody">
                                <tr class="empty-row">
                                    <td colspan="4">No teams</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="pagination" id="team-pagination"></div>
                </section>
            </div>

            <!-- Roles Sub-tab Content -->
            <div class="sub-tab-content" id="subtab-roles">
                <section class="card">
                    <div class="column-header">
                        <div class="section-header-with-help">
                            <h2>Roles</h2>
                            <a href="#" class="section-help-icon" data-help="mapping-tab" title="Help: How to use Roles">?</a>
                        </div>
                        <button id="add-role-btn" class="btn btn-secondary">Add</button>
                    </div>
                    <div class="filter-search">
                        <input type="text" id="role-search" placeholder="Search roles..." class="input">
                    </div>
                    <div class="table-container">
                        <table class="entity-table">
                            <thead>
                                <tr>
                                    <th class="row-number-col">#</th>
                                    <th>Role name</th>
                                    <th>Default Work Type</th>
                                    <th>People</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="role-tbody">
                                <tr class="empty-row">
                                    <td colspan="5">No roles</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="pagination" id="role-pagination"></div>
                </section>
            </div>

            <!-- Work Types Sub-tab Content -->
            <div class="sub-tab-content" id="subtab-work-types">
                <section class="card">
                    <div class="column-header">
                        <div class="section-header-with-help">
                            <h2>Work Types</h2>
                            <a href="#" class="section-help-icon" data-help="mapping-tab" title="Help: How to use Work Types">?</a>
                        </div>
                        <button id="add-work-type-btn" class="btn btn-secondary">Add</button>
                    </div>
                    <div class="filter-search">
                        <input type="text" id="work-type-search" placeholder="Search work types..." class="input">
                    </div>
                    <div class="table-container">
                        <table class="entity-table">
                            <thead>
                                <tr>
                                    <th class="row-number-col">#</th>
                                    <th>Work Type name</th>
                                    <th>Roles</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="work-type-tbody">
                                <tr class="empty-row">
                                    <td colspan="4">No work types</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="pagination" id="work-type-pagination"></div>
                </section>
            </div>

            <!-- People Section (Full Width) -->
            <section class="card">
                <div class="column-header">
                    <div class="section-header-with-help">
                        <h2>People</h2>
                        <a href="#" class="section-help-icon" data-help="mapping-tab" title="Help: How to use People">?</a>
                    </div>
                    <div class="column-actions">
                        <button id="add-person-btn" class="btn btn-secondary">Add</button>
                        <button id="import-csv-people-btn" class="btn btn-secondary">From CSV</button>
                    </div>
                </div>
                <div class="filter-row">
                    <input type="text" id="person-search" placeholder="Search people..." class="input">
                    <select id="person-team-filter" class="select select-sm">
                        <option value="">All Teams</option>
                    </select>
                    <select id="person-project-filter" class="select select-sm">
                        <option value="">All Projects</option>
                    </select>
                    <select id="person-role-filter" class="select select-sm">
                        <option value="">All Roles</option>
                    </select>
                </div>                <div class="table-container">
                    <table class="entity-table">
                        <thead>
                            <tr>
                                <th class="row-number-col">#</th>
                                <th>Name</th>
                                <th>Team</th>
                                <th>Project</th>
                                <th>Role</th>
                                <th id="people-hours-header">Total hours logged</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="person-tbody">
                            <tr class="empty-row">
                                <td colspan="7">No people</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="pagination" id="person-pagination"></div>
            </section>
        </div>

        <div class="tab-content" id="tab-data">
            <!-- Filters Section -->
            <section class="card">
                <div class="filters-header">
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <h2>Filters</h2>
                        <a href="#" class="section-help-icon" data-help="filters" title="Help: How to use Filters">?</a>
                        <span id="filters-badge" class="filter-badge" style="display: none;"></span>
                    </div>
                    <button id="toggle-advanced-filters" class="btn-text">+ Advanced Filters <span id="advanced-filters-badge" class="filter-badge" style="display: none;"></span></button>
                </div>
                <div class="filters-grid">
                    <div class="filter-group">
                        <label for="project-filter">
                            <span class="filter-label-with-badge">
                                Project
                                <span id="project-filter-count" class="filter-count-badge" style="display: none;"></span>
                                <button class="filter-clear-btn" id="clear-project-filter" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                            <label class="filter-not-label">
                                <input type="checkbox" id="project-filter-not" class="checkbox">
                                <span>not</span>
                            </label>
                        </label>
                        <select id="project-filter" class="select" multiple size="4">
                            <option value="">All Projects</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="team-filter">
                            <span class="filter-label-with-badge">
                                Team
                                <span id="team-filter-count" class="filter-count-badge" style="display: none;"></span>
                                <button class="filter-clear-btn" id="clear-team-filter" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                            <label class="filter-not-label">
                                <input type="checkbox" id="team-filter-not" class="checkbox">
                                <span>not</span>
                            </label>
                        </label>
                        <select id="team-filter" class="select" multiple size="4">
                            <option value="">All Teams</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="role-filter">
                            <span class="filter-label-with-badge">
                                Role
                                <span id="role-filter-count" class="filter-count-badge" style="display: none;"></span>
                                <button class="filter-clear-btn" id="clear-role-filter" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                            <label class="filter-not-label">
                                <input type="checkbox" id="role-filter-not" class="checkbox">
                                <span>not</span>
                            </label>
                        </label>
                        <select id="role-filter" class="select" multiple size="4">
                            <option value="">All Roles</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="work-type-filter">
                            <span class="filter-label-with-badge">
                                Work Type
                                <span id="work-type-filter-count" class="filter-count-badge" style="display: none;"></span>
                                <button class="filter-clear-btn" id="clear-work-type-filter" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                            <label class="filter-not-label">
                                <input type="checkbox" id="work-type-filter-not" class="checkbox">
                                <span>not</span>
                            </label>
                        </label>
                        <select id="work-type-filter" class="select" multiple size="4">
                            <option value="">All Work Types</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="servis-filter">
                            <span class="filter-label-with-badge">
                                Servis
                                <span id="servis-filter-count" class="filter-count-badge" style="display: none;"></span>
                                <button class="filter-clear-btn" id="clear-servis-filter" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                            <label class="filter-not-label">
                                <input type="checkbox" id="servis-filter-not" class="checkbox">
                                <span>not</span>
                            </label>
                        </label>
                        <select id="servis-filter" class="select" multiple size="4">
                            <option value="">All Servis</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="work-date-start">
                            <span class="filter-label-with-badge">
                                Work Date From
                                <button class="filter-clear-btn" id="clear-work-date-start" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                        </label>
                        <input type="date" id="work-date-start" class="input">
                    </div>
                    <div class="filter-group">
                        <label for="work-date-end">
                            <span class="filter-label-with-badge">
                                Work Date To
                                <button class="filter-clear-btn" id="clear-work-date-end" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                        </label>
                        <input type="date" id="work-date-end" class="input">
                    </div>
                    <div class="filter-group">
                        <label for="issue-summary-filter">
                            <span class="filter-label-with-badge">
                                Issue Summary
                                <span id="issue-summary-filter-count" class="filter-count-badge" style="display: none;"></span>
                                <button class="filter-clear-btn" id="clear-issue-summary-filter" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                            <label class="filter-not-label">
                                <input type="checkbox" id="issue-summary-not" class="checkbox">
                                <span>not</span>
                            </label>
                        </label>
                        <input type="text" id="issue-summary-filter" class="input" placeholder="Search in issue summary...">
                    </div>
                </div>
                <div id="advanced-filters" class="filters-grid advanced-filters" style="display: none; margin-top: 16px;">
                    <div class="filter-group">
                        <label for="activity-filter">
                            <span class="filter-label-with-badge">
                                Activity Name
                                <span id="activity-filter-count" class="filter-count-badge" style="display: none;"></span>
                                <button class="filter-clear-btn" id="clear-activity-filter" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                            <label class="filter-not-label">
                                <input type="checkbox" id="activity-filter-not" class="checkbox">
                                <span>not</span>
                            </label>
                        </label>
                        <select id="activity-filter" class="select" multiple size="4">
                            <option value="">All Activities</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="person-filter">
                            <span class="filter-label-with-badge">
                                Person
                                <span id="person-filter-count" class="filter-count-badge" style="display: none;"></span>
                                <button class="filter-clear-btn" id="clear-person-filter" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                            <label class="filter-not-label">
                                <input type="checkbox" id="person-filter-not" class="checkbox">
                                <span>not</span>
                            </label>
                        </label>
                        <select id="person-filter" class="select" multiple size="4">
                            <option value="">All Persons</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="issue-status-filter">
                            <span class="filter-label-with-badge">
                                Issue Status
                                <span id="issue-status-filter-count" class="filter-count-badge" style="display: none;"></span>
                                <button class="filter-clear-btn" id="clear-issue-status-filter" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                            <label class="filter-not-label">
                                <input type="checkbox" id="issue-status-filter-not" class="checkbox">
                                <span>not</span>
                            </label>
                        </label>
                        <select id="issue-status-filter" class="select" multiple size="4">
                            <option value="">All Statuses</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="project-key-filter">
                            <span class="filter-label-with-badge">
                                Project Key
                                <span id="project-key-filter-count" class="filter-count-badge" style="display: none;"></span>
                                <button class="filter-clear-btn" id="clear-project-key-filter" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                            <label class="filter-not-label">
                                <input type="checkbox" id="project-key-filter-not" class="checkbox">
                                <span>not</span>
                            </label>
                        </label>
                        <select id="project-key-filter" class="select" multiple size="4">
                            <option value="">All Project Keys</option>
                        </select>
                    </div>
                </div>
                <div class="filter-actions">
                    <button id="apply-filters-btn" class="btn btn-secondary">Apply Filters</button>
                    <button id="clear-filters-btn" class="btn btn-secondary">Clear Filters</button>
                    <button id="manage-servis-btn" class="btn btn-secondary" style="margin-left: auto;">‚öôÔ∏è Manage Servis Names</button>
                </div>
            </section>

        <!-- Data View Section -->
        <section class="card">
            <div class="section-header">
                <div class="section-header-with-help">
                    <h2>Filtered Data</h2>
                    <a href="#" class="section-help-icon" data-help="timesheet-data-tab" title="Help: Managing Timesheet Data">?</a>
                </div>
                <div class="section-actions">
                    <button id="import-csv-data-btn" class="action-btn" title="Import Timesheet Data (CSV)">üì§ Import</button>
                    <button id="export-csv-btn" class="action-btn" title="Export Filtered Data (CSV)">üì• Export</button>
                    <button id="clear-all-data-btn" class="action-btn" style="background-color: #dc3545; color: white;" title="Clear All Timesheet Data">Clear All</button>
                </div>
            </div>
            <div class="data-summary">
                <div class="summary-item">
                    <span class="summary-label">Total Records</span>
                    <span id="total-records" class="summary-value">0</span>
                </div>
                <div class="summary-item">
                    <span id="total-hours-label" class="summary-label">Total Hours</span>
                    <span id="total-hours" class="summary-value">0</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Unique People</span>
                    <span id="unique-people" class="summary-value">0</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Unique Issues</span>
                    <span id="unique-issues" class="summary-value">0</span>
                </div>
            </div>
            <div class="mapping-options" style="padding: 12px 0; border-top: 1px solid #e0e0e0; border-bottom: 1px solid #e0e0e0; margin: 12px 0; display: flex; align-items: center; justify-content: space-between; gap: 24px; flex-wrap: wrap;">
                <div style="display: flex; align-items: center; gap: 12px;">
                    <button id="apply-person-mapping-btn" class="btn btn-secondary" title="Apply Person Mapping to Filtered Data">Apply Mapping</button>
                </div>
                <div id="batch-update-section" style="display: flex; flex-direction: column; gap: 8px; align-items: flex-end;">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <span style="font-weight: 500; font-size: 14px;">Batch Update (<span id="selected-count">0</span> selected):</span>
                        <label style="display: flex; align-items: center; gap: 6px; font-size: 13px; margin: 0; cursor: pointer;" title="Select all filtered records across all pages">
                            <input type="checkbox" id="select-all-filtered" class="checkbox">
                            <span>All <span id="total-filtered-count">0</span> filtered</span>
                        </label>
                        <select id="batch-field-select" class="select" style="width: auto; min-width: 120px;">
                            <option value="">Select Field</option>
                            <option value="team">Team</option>
                            <option value="workType">Work Type</option>
                            <option value="project">Project</option>
                        </select>
                        <select id="batch-value-select" class="select" style="width: auto; min-width: 150px;" disabled>
                            <option value="">Select Value</option>
                        </select>
                        <button id="batch-update-btn" class="btn btn-primary" disabled>Update</button>
                    </div>
                </div>
            </div>
            <div class="table-container">
                <table id="data-table" class="data-table">
                    <thead>
                        <tr>
                            <th style="width: 40px;"><input type="checkbox" id="select-all-rows" class="checkbox"></th>
                            <th>Work Date</th>
                            <th>Servis</th>
                            <th>Project Key</th>
                            <th>Person Name</th>
                            <th>Activity Name</th>
                            <th>Issue Summary</th>
                            <th>Issue Status</th>
                            <th id="filtered-data-hours-header">Efor (hour)</th>
                            <th>Team</th>
                            <th>Work Type</th>
                            <th>Project</th>
                        </tr>
                    </thead>
                    <tbody id="data-tbody">
                        <tr class="empty-row">
                            <td colspan="12">No data to display. Please import a CSV file.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="pagination" id="data-pagination"></div>
        </section>
        </div> <!-- Close tab-data -->

        <div class="tab-content" id="tab-reports">
            <!-- Filters Section (sync with Timesheet Data) -->
            <section class="card compact-card">
                <div class="filters-header">
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <h2>Filters</h2>
                        <a href="#" class="section-help-icon" data-help="filters" title="Help: How to use Filters">?</a>
                        <span id="report-filters-badge" class="filter-badge" style="display: none;"></span>
                    </div>
                    <button id="toggle-report-advanced-filters" class="btn-text">+ Advanced Filters <span id="report-advanced-filters-badge" class="filter-badge" style="display: none;"></span></button>
                </div>
                <div class="filters-grid">
                    <div class="filter-group">
                        <label for="report-project-filter">
                            <span class="filter-label-with-badge">
                                Project
                                <span id="report-project-filter-count" class="filter-count-badge" style="display: none;"></span>
                                <button class="filter-clear-btn" id="clear-report-project-filter" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                            <label class="filter-not-label">
                                <input type="checkbox" id="report-project-filter-not" class="checkbox">
                                <span>not</span>
                            </label>
                        </label>
                        <select id="report-project-filter" class="select" multiple size="3">
                            <option value="">All Projects</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="report-team-filter">
                            <span class="filter-label-with-badge">
                                Team
                                <span id="report-team-filter-count" class="filter-count-badge" style="display: none;"></span>
                                <button class="filter-clear-btn" id="clear-report-team-filter" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                            <label class="filter-not-label">
                                <input type="checkbox" id="report-team-filter-not" class="checkbox">
                                <span>not</span>
                            </label>
                        </label>
                        <select id="report-team-filter" class="select" multiple size="3">
                            <option value="">All Teams</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="report-role-filter">
                            <span class="filter-label-with-badge">
                                Role
                                <span id="report-role-filter-count" class="filter-count-badge" style="display: none;"></span>
                                <button class="filter-clear-btn" id="clear-report-role-filter" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                            <label class="filter-not-label">
                                <input type="checkbox" id="report-role-filter-not" class="checkbox">
                                <span>not</span>
                            </label>
                        </label>
                        <select id="report-role-filter" class="select" multiple size="3">
                            <option value="">All Roles</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="report-work-type-filter">
                            <span class="filter-label-with-badge">
                                Work Type
                                <span id="report-work-type-filter-count" class="filter-count-badge" style="display: none;"></span>
                                <button class="filter-clear-btn" id="clear-report-work-type-filter" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                            <label class="filter-not-label">
                                <input type="checkbox" id="report-work-type-filter-not" class="checkbox">
                                <span>not</span>
                            </label>
                        </label>
                        <select id="report-work-type-filter" class="select" multiple size="3">
                            <option value="">All Work Types</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="report-servis-filter">
                            <span class="filter-label-with-badge">
                                Servis
                                <span id="report-servis-filter-count" class="filter-count-badge" style="display: none;"></span>
                                <button class="filter-clear-btn" id="clear-report-servis-filter" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                            <label class="filter-not-label">
                                <input type="checkbox" id="report-servis-filter-not" class="checkbox">
                                <span>not</span>
                            </label>
                        </label>
                        <select id="report-servis-filter" class="select" multiple size="3">
                            <option value="">All Servis</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="report-work-date-start">
                            <span class="filter-label-with-badge">
                                Work Date From
                                <button class="filter-clear-btn" id="clear-report-work-date-start" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                        </label>
                        <input type="date" id="report-work-date-start" class="input">
                    </div>
                    <div class="filter-group">
                        <label for="report-work-date-end">
                            <span class="filter-label-with-badge">
                                Work Date To
                                <button class="filter-clear-btn" id="clear-report-work-date-end" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                        </label>
                        <input type="date" id="report-work-date-end" class="input">
                    </div>
                    <div class="filter-group">
                        <label for="report-issue-summary-filter">
                            <span class="filter-label-with-badge">
                                Issue Summary
                                <span id="report-issue-summary-filter-count" class="filter-count-badge" style="display: none;"></span>
                                <button class="filter-clear-btn" id="clear-report-issue-summary-filter" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                            <label class="filter-not-label">
                                <input type="checkbox" id="report-issue-summary-not" class="checkbox">
                                <span>not</span>
                            </label>
                        </label>
                        <input type="text" id="report-issue-summary-filter" class="input" placeholder="Search in issue summary...">
                    </div>
                </div>
                <div id="report-advanced-filters" class="filters-grid advanced-filters" style="display: none; margin-top: 16px;">
                    <div class="filter-group">
                        <label for="report-activity-filter">
                            <span class="filter-label-with-badge">
                                Activity Name
                                <span id="report-activity-filter-count" class="filter-count-badge" style="display: none;"></span>
                                <button class="filter-clear-btn" id="clear-report-activity-filter" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                            <label class="filter-not-label">
                                <input type="checkbox" id="report-activity-filter-not" class="checkbox">
                                <span>not</span>
                            </label>
                        </label>
                        <select id="report-activity-filter" class="select" multiple size="3">
                            <option value="">All Activities</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="report-person-filter">
                            <span class="filter-label-with-badge">
                                Person
                                <span id="report-person-filter-count" class="filter-count-badge" style="display: none;"></span>
                                <button class="filter-clear-btn" id="clear-report-person-filter" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                            <label class="filter-not-label">
                                <input type="checkbox" id="report-person-filter-not" class="checkbox">
                                <span>not</span>
                            </label>
                        </label>
                        <select id="report-person-filter" class="select" multiple size="3">
                            <option value="">All Persons</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="report-issue-status-filter">
                            <span class="filter-label-with-badge">
                                Issue Status
                                <span id="report-issue-status-filter-count" class="filter-count-badge" style="display: none;"></span>
                                <button class="filter-clear-btn" id="clear-report-issue-status-filter" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                            <label class="filter-not-label">
                                <input type="checkbox" id="report-issue-status-filter-not" class="checkbox">
                                <span>not</span>
                            </label>
                        </label>
                        <select id="report-issue-status-filter" class="select" multiple size="3">
                            <option value="">All Statuses</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="report-project-key-filter">
                            <span class="filter-label-with-badge">
                                Project Key
                                <span id="report-project-key-filter-count" class="filter-count-badge" style="display: none;"></span>
                                <button class="filter-clear-btn" id="clear-report-project-key-filter" style="display: none;" title="Clear filter">√ó</button>
                            </span>
                            <label class="filter-not-label">
                                <input type="checkbox" id="report-project-key-filter-not" class="checkbox">
                                <span>not</span>
                            </label>
                        </label>
                        <select id="report-project-key-filter" class="select" multiple size="3">
                            <option value="">All Project Keys</option>
                        </select>
                    </div>
                </div>
                <div class="filter-actions" style="justify-content: flex-start;">
                    <button id="generate-report-btn" class="btn btn-secondary" style="padding: 8px 24px; font-size: 14px;">üìà Generate Chart</button>
                    <button id="clear-report-filters-btn" class="btn btn-secondary">Clear Filters</button>
                </div>
            </section>

            <!-- Report Generation Section -->
            <section class="card compact-card">
                <div class="section-header-with-help" style="margin-bottom: 16px;">
                    <h2>Report</h2>
                    <a href="#" class="section-help-icon" data-help="reports-tab" title="Help: Generating Reports">?</a>
                </div>
            <div class="report-controls">
                <div class="report-controls-grid">
                    <!-- Left Column: Report Controls -->
                    <div class="report-controls-left">
                        <div class="report-type-selector">
                            <label for="report-type-select">Report Type:</label>
                            <select id="report-type-select" class="select">
                                <option value="person">Person Name</option>
                                <option value="team">Team</option>
                                <option value="project">Project</option>
                                <option value="role">Role</option>
                                <option value="workType">Work Type</option>
                                <option value="activity">Activity Name</option>
                                <option value="servis">Servis</option>
                                <option value="status">Issue Status</option>
                                <option value="epic">Epic</option>
                                <option value="projectKey">Project Key</option>
                                <option value="issueKey">Issue Key</option>
                            </select>
                        </div>
                        <div class="report-type-selector">
                            <label for="chart-type-select">Chart Type:</label>
                            <select id="chart-type-select" class="select">
                                <option value="donut">Donut Chart</option>
                                <option value="timeseries">Time Series</option>
                            </select>
                        </div>
                        <div class="report-type-selector">
                            <label for="time-granularity-select">Time Period:</label>
                            <select id="time-granularity-select" class="select">
                                <option value="daily">Daily</option>
                                <option value="weekly" selected>Weekly</option>
                                <option value="monthly">Monthly</option>
                                <option value="quarterly">Quarterly</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Right Column: Visual Controls -->
                    <div class="report-controls-right">
                        <div class="visual-controls-row">
                            <div class="rotation-control">
                                <label for="rotation-slider" class="rotation-label">Rotation: <span id="rotation-value">-55</span>¬∞</label>
                                <input type="range" id="rotation-slider" class="rotation-slider" min="-180" max="180" value="-55" title="Adjust start angle">
                            </div>
                            
                            <div class="control-group">
                                <label for="theme-select">Theme:</label>
                                <select id="theme-select" class="select"></select>
                            </div>
                        </div>
                        
                        <div class="visual-controls-row">
                            <div class="font-size-controls">
                                <button id="font-decrease" class="btn-icon" title="Decrease font size">A‚àí</button>
                                <span id="font-size-display" class="font-size-display">16</span>
                                <button id="font-increase" class="btn-icon" title="Increase font size">A+</button>
                            </div>
                            
                            <div class="control-group">
                                <label for="font-family-select">Font:</label>
                                <select id="font-family-select" class="select">
                                    <option value="Helvetica">Helvetica</option>
                                    <option value="Arial">Arial</option>
                                    <option value="Times New Roman">Times New Roman</option>
                                    <option value="Verdana">Verdana</option>
                                    <option value="Georgia">Georgia</option>
                                    <option value="-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto">System Default</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="chart-wrapper">
                <canvas id="report-chart" style="height: 500px;"></canvas>
            </div>
            
            <!-- Data List Management -->
            <div class="data-list-section">
                <h3>Report Data Points</h3>
                <p class="data-list-hint">Drag and drop to reorder</p>
                <div id="report-data-list" class="report-data-list">
                    <p style="color: #9ca3af; text-align: center; padding: 20px;">Generate a report to see data points</p>
                </div>
            </div>
        </section>

        </section>
        </div> <!-- Close tab-reports -->

        <!-- Help/Guide Tab -->
        <div id="tab-help" class="tab-content">
            <div class="guide-container">
                <!-- Floating Table of Contents -->
                <nav class="guide-toc">
                    <h3>Contents</h3>
                    <ul id="guide-toc-list">
                        <!-- ToC will be generated from USER_GUIDE.md -->
                    </ul>
                </nav>
                
                <!-- Guide Content -->
                <div class="guide-content" id="guide-content-container">
                    <!-- Content will be loaded from USER_GUIDE.md -->
                </div> <!-- Close guide-content -->
            </div> <!-- Close guide-container -->
        </div> <!-- Close tab-help -->
    </div>

    <!-- Hidden file input for CSV import -->
    <input type="file" id="csv-file" accept=".csv" style="display: none;">

    <!-- Hidden file input for project/team/role/people CSV import in Mapping tab -->
    <input type="file" id="mapping-csv-file" accept=".csv" style="display: none;">

    <!-- Modal for Add/Edit -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">Add/Edit</h2>
                <button class="modal-close" id="modal-close">&times;</button>
            </div>
            <div class="modal-body" id="modal-body">
                <!-- Dynamic content -->
            </div>
            <div class="modal-footer">
                <button id="modal-cancel" class="btn btn-secondary">Cancel</button>
                <button id="modal-save" class="btn btn-secondary">Save</button>
            </div>
        </div>
    </div>

    <!-- Import Validation Modal -->
    <div id="validation-modal" class="modal">
        <div class="modal-content" style="max-width: 90%; max-height: 90vh;">
            <div class="modal-header">
                <h2>CSV Import Validation</h2>
                <button class="modal-close" id="validation-modal-close">&times;</button>
            </div>
            <div class="modal-body" style="overflow-y: auto; max-height: calc(90vh - 180px);">
                <div id="validation-summary" style="margin-bottom: 20px;">
                    <!-- Summary will be inserted here -->
                </div>
                
                <div id="validation-tabs" style="margin-bottom: 10px;">
                    <button class="tab-btn active" data-validation-tab="skipped">Skipped Rows</button>
                    <button class="tab-btn" data-validation-tab="valid">Valid Rows (Preview)</button>
                </div>
                
                <div id="validation-tab-skipped" class="validation-tab-content active">
                    <div style="margin-bottom: 10px;">
                        <button id="export-skipped-btn" class="btn btn-secondary btn-sm">üì• Export Skipped Rows</button>
                        <button id="auto-fix-btn" class="btn btn-secondary btn-sm">üîß Auto-Fix Common Issues</button>
                    </div>
                    <div id="skipped-rows-container" style="overflow-x: auto;">
                        <!-- Skipped rows table will be inserted here -->
                    </div>
                </div>
                
                <div id="validation-tab-valid" class="validation-tab-content" style="display: none;">
                    <div id="valid-rows-preview" style="overflow-x: auto;">
                        <!-- Valid rows preview will be inserted here -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="validation-cancel" class="btn btn-secondary">Cancel Import</button>
                <button id="validation-proceed" class="btn btn-secondary">Proceed with Valid Rows</button>
            </div>
        </div>
    </div>

    <!-- Apply Mapping Modal -->
    <div id="apply-mapping-modal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2>Apply Person Mapping</h2>
                <button class="modal-close" id="apply-mapping-modal-close">&times;</button>
            </div>
            <div class="modal-body" style="padding: 24px;">
                <p style="margin-bottom: 20px; color: #666; font-size: 14px;">
                    Apply person mappings to fill Team, Project, and Work Type fields based on the person who logged the time.
                </p>
                
                <div style="margin-bottom: 24px;">
                    <h3 style="margin: 0 0 12px 0; font-size: 14px; font-weight: 600;">Apply to Fields:</h3>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <label style="display: flex; align-items: center; gap: 8px; font-size: 14px; cursor: pointer;">
                            <input type="checkbox" id="modal-apply-mapping-team" class="checkbox" checked>
                            <span>Team</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; font-size: 14px; cursor: pointer;">
                            <input type="checkbox" id="modal-apply-mapping-project" class="checkbox" checked>
                            <span>Project</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; font-size: 14px; cursor: pointer;">
                            <input type="checkbox" id="modal-apply-mapping-worktype" class="checkbox" checked>
                            <span>Work Type</span>
                        </label>
                    </div>
                </div>
                
                <div style="padding: 16px; background: #f9f9f9; border-radius: 8px; border: 1px solid #e0e0e0;">
                    <label style="display: flex; align-items: center; gap: 8px; font-size: 14px; cursor: pointer;">
                        <input type="checkbox" id="modal-override-existing-mapping" class="checkbox">
                        <span style="font-weight: 500;">Override Existing Values</span>
                    </label>
                    <p style="margin: 8px 0 0 32px; font-size: 12px; color: #666; line-height: 1.4;">
                        When enabled, replaces existing field values with person mapping.<br>
                        When disabled, only fills empty fields.
                    </p>
                </div>
            </div>
            <div class="modal-footer">
                <button id="apply-mapping-cancel-btn" class="btn btn-secondary">Cancel</button>
                <button id="apply-mapping-execute-btn" class="btn btn-primary">Apply</button>
            </div>
        </div>
    </div>

    <!-- Servis Management Modal -->
    <div id="servis-modal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2>Manage Servis Names</h2>
                <button class="modal-close" id="servis-modal-close">&times;</button>
            </div>
            <div class="modal-body" style="overflow-y: auto; max-height: 60vh;">
                <p style="margin-bottom: 15px; color: #666;">Define display names for Servis numbers. Format: "Number - Name"</p>
                <div style="margin-bottom: 15px;">
                    <button id="add-servis-mapping-btn" class="btn btn-secondary btn-sm">+ Add New Mapping</button>
                </div>
                <div class="table-container">
                    <table class="entity-table">
                        <thead>
                            <tr>
                                <th style="width: 150px;">Servis Number</th>
                                <th>Display Name</th>
                                <th style="width: 100px;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="servis-mapping-tbody">
                            <tr class="empty-row">
                                <td colspan="3">No Servis mappings defined</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button id="servis-modal-close-btn" class="btn btn-secondary">Close</button>
            </div>
        </div>
    </div>

    <!-- Data Point Details Modal -->
    <div id="datapoint-details-modal" class="modal">
        <div class="modal-content" style="max-width: 95%; max-height: 90vh;">
            <div class="modal-header">
                <h2 id="datapoint-details-title">Data Point Details</h2>
                <button class="modal-close" id="datapoint-details-close">&times;</button>
            </div>
            <div class="modal-body" style="overflow-y: auto; max-height: calc(90vh - 140px);">
                <!-- Statistics Summary -->
                <div class="data-summary" style="margin-bottom: 20px;">
                    <div class="summary-item">
                        <span class="summary-label">Total Records</span>
                        <span class="summary-value" id="datapoint-stat-records">-</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Unique People</span>
                        <span class="summary-value" id="datapoint-stat-people">-</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label" id="datapoint-stat-hours-label">Total Hours</span>
                        <span class="summary-value" id="datapoint-stat-hours">-</span>
                    </div>
                </div>

                <!-- Filters -->
                <div style="margin-bottom: 20px; padding: 16px; background: var(--background); border-radius: var(--border-radius); border: 1px solid var(--border-color);">
                    <h3 style="margin: 0 0 16px 0; font-size: 14px; font-weight: 600; color: var(--text-primary);">Filters</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 16px;">
                        <div class="form-group">
                            <label for="datapoint-filter-project">Project</label>
                            <select id="datapoint-filter-project" class="select">
                                <option value="">All Projects</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="datapoint-filter-team">Team</label>
                            <select id="datapoint-filter-team" class="select">
                                <option value="">All Teams</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="datapoint-filter-role">Role</label>
                            <select id="datapoint-filter-role" class="select">
                                <option value="">All Roles</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="datapoint-filter-worktype">Work Type</label>
                            <select id="datapoint-filter-worktype" class="select">
                                <option value="">All Work Types</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="datapoint-filter-person">Person</label>
                            <select id="datapoint-filter-person" class="select">
                                <option value="">All People</option>
                            </select>
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; justify-content: flex-end;">
                        <button id="datapoint-clear-filters" class="btn btn-secondary btn-sm">Clear Filters</button>
                        <button id="datapoint-export-csv" class="btn btn-secondary btn-sm">üì• Export CSV</button>
                    </div>
                </div>

                <!-- Data Table -->
                <div class="table-container">
                    <table id="datapoint-details-table" class="data-table">
                        <thead>
                            <tr>
                                <th>Work Date</th>
                                <th>Person</th>
                                <th>Project</th>
                                <th>Team</th>
                                <th>Role</th>
                                <th>Work Type</th>
                                <th>Hours</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody id="datapoint-details-tbody">
                            <tr class="empty-row">
                                <td colspan="8">No records to display</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- Pagination -->
                <div class="pagination" id="datapoint-pagination" style="display: none;"></div>
            </div>
            <div class="modal-footer">
                <button id="datapoint-details-close-btn" class="btn btn-secondary">Close</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
